<section class="carousel-stripe content-stripe content-stripe--half">
  <div class="wrapper">
    <h2 class="uppercase-title">{{ section.settings.heading }}</h2>

    {% unless section.settings.intro == blank %}

      {{ section.settings.intro }}

    {% endunless %}

    {% for block in section.blocks %}

      <div class="shop-carousel">

        {% for product in collections[block.settings.carousel].products %}
<script type='application/json' class='bold-product-json'>{{ product | json }}</script>

          {% include 'product-carousel-item' %}

        {% endfor %}

      </div>

    {% endfor %}

  </div><!-- .wrapper -->
</section>

{% javascript %}
$(document).ready(function(){
  $('.shop-carousel').flickity({
    cellSelector: '.item',
    wrapAround: true,
    cellAlign: 'left',
    pageDots: false,
    imagesLoaded: true
  });
});
{% endjavascript %}

{% schema %}
{
  "name": {
    "en": "Product carousel"
  },
  "class": "index-section index-section--flush",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": {
        "en": "Heading"
      },
      "default": {
        "en": "Section heading"
      }
    },
    {
      "type": "richtext",
      "id": "intro",
      "label": {
        "en": "Introduction"
      },
      "default": {
        "en": "<p>Introductory paragraph</p>"
      }
    }
  ],
  "blocks": [
    {
      "type": "carousel",
      "name": "Carousel",
      "settings": [
        {
          "type": "collection",
          "id": "carousel",
          "label": {
            "en": "Product Carousel"
          }
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product carousels",
      "category": "Homepage sections",
      "blocks": [
        {
          "type": "carousel"
        }
      ]
    }
  ]
}
{% endschema %}
